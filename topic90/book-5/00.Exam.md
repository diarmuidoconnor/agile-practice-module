## DevOps Practice Exam - 2025.

__Important__:
1. You must use your clone of the `devops-exam-2025` repository for this exam.
1. You must adhere to the git commit requirements stated in the exam question. Failure to do so will mean your submission is void. 
1. It is not necessary to do a git push after every commit; a push operation at the end of the exam is sufficient.
1. This is an open-book exam in the conventional sense; AI tools and services cannot be used.

__Duration:__ 90 minutes.

### Question.

Notes:
1. You must perform a git commit after creating each manifest file (YAML), and every time you redeploy these files. 
1. Use [this][data] JSON file to seed the MongoDB database. The Mongo Compass tool can be used to connect to the pod or service running the MongoDB container. 

#### The application.

![][arch]

A containerised application consists of three components, as illustrated above. The Web API provides information about solar planets:
+ GET /planets - get information on all planets
+ GET /planets/{id} - information about a specific planet

The Solar information is persisted in a MongoDB database, and a Redis caching server is used for short-term caching to improve API response times. A sample of  response from the API is shown below

![][response]

__You are required__ to deploy this application to the OCP Kubernetes cluster as a set of pods and services. The deployment should be configurable, persistent, and secure.

##### Technical detail.

The Docker CLI commands to set up this application locally are (you do not need to run these commands locally):
~~~bash
$ docker network create app-network.   
 
$ docker run -d --net app-network \
       --name my-mongoDB  \
       -p 27017:27017 \
       -e MONGODB_ROOT_USER=admin \
       -e MONGODB_ROOT_PASSWORD=secret \
    bitnami/mongodb:latest

$ docker run -d --net app-network \
       --name my-redis  \
       -p 6379:6379 \
    redis:alpine

$  docker run -d --net app-network \
       --name rust-api  \
       -p 9000:9000 \
       -e MONGODB_URI=mongodb://admin:secret@my-mongoDB:27017/ \
       -e REDIS_URI=redis://my-redis \
       -e ENABLE_WRITING_HANDLERS=false \
       -e RUST_LOG=debug \
    doconnor/rust-api:1.0-amd64
~~~
Some points to note:
+ The Redis caching server listens on port 6379 by default.
+ The Web API Docker image (doconnor/rust-api:1.0-amd64) listens on port 9000. Its environment variables are:
    + MONGODB_URI - Set this to the connection string of the MongoDB database,
    + REDIS_URI - Set this to the connection string of the Redis server. The string's format is: protocol://redis-server-domain-name, where the protocol is 'redis'.
    + The other two variables are standard: ENABLE_WRITING_HANDLERS and RUST_LOG.
+ Use [this][data] JSON file to seed the MongoDB database.
+ The custom network (app-network) is required to enable domain-name resolution. It is not relevant in a Kubernetes environment as this resolution is automatic.

Test your deployment by enabling port forwarding on the Web API pod/service, then navigate to http://localhost:9000/planets in the browser. The response should display the set of planet data you used to seed the database. 

-------------------------------------

### Make sure you push your local git commits to GitHub at the end of the exam.

[arch]: ./img/arch.png
[response]: ./img/response.png
[data]: ./img//data.zip